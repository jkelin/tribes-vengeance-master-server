extern crate encrtypex_decoder;

use encrtypex_decoder::enctypex_encrypt;
use encrtypex_decoder::enctypex_decrypt;

#[macro_use]
extern crate criterion;

use criterion::Criterion;

fn encrypt(c: &mut Criterion) {
    let key = vec![121,51,68,50,56,107];
    let validate = vec![46,57,123,82,77,92,47,54];
    let data_in = vec![90,178,44,86,0,0,14,0,109,97,112,110,97,109,101,0,0,110,117,109,112,108,97,121,101,114,115,0,0,109,97,120,112,108,97,121,101,114,115,0,0,104,111,115,116,110,97,109,101,0,0,104,111,115,116,112,111,114,116,0,0,103,97,109,101,116,121,112,101,0,0,103,97,109,101,118,101,114,0,0,112,97,115,115,119,111,114,100,0,0,103,97,109,101,110,97,109,101,0,0,103,97,109,101,109,111,100,101,0,0,103,97,109,101,118,97,114,105,97,110,116,0,0,116,114,97,99,107,105,110,103,115,116,97,116,115,0,0,100,101,100,105,99,97,116,101,100,0,0,109,105,110,118,101,114,0,0,21,176,9,148,187,30,108,21,72,54,15,202,30,98,0];

    c.bench_function("bench_encrypt", move |b| b.iter(|| {
        enctypex_encrypt(&key, &validate, &data_in)
    }));
}

fn decrypt(c: &mut Criterion) {
    let key = vec![121,51,68,50,56,107];
    let validate = vec![46,57,123,82,77,92,47,54];
    let data_in = vec![90,178,44,86,0,0,14,0,109,97,112,110,97,109,101,0,0,110,117,109,112,108,97,121,101,114,115,0,0,109,97,120,112,108,97,121,101,114,115,0,0,104,111,115,116,110,97,109,101,0,0,104,111,115,116,112,111,114,116,0,0,103,97,109,101,116,121,112,101,0,0,103,97,109,101,118,101,114,0,0,112,97,115,115,119,111,114,100,0,0,103,97,109,101,110,97,109,101,0,0,103,97,109,101,109,111,100,101,0,0,103,97,109,101,118,97,114,105,97,110,116,0,0,116,114,97,99,107,105,110,103,115,116,97,116,115,0,0,100,101,100,105,99,97,116,101,100,0,0,109,105,110,118,101,114,0,0,21,176,9,148,187,30,108,21,72,54,15,202,30,98,0];
    let encrypted = enctypex_encrypt(&key, &validate, &data_in).expect("Could not encrypt");

    c.bench_function("bench_decrypt", move |b| b.iter(|| {
        enctypex_decrypt(&key, &validate, &encrypted)
    }));
}

criterion_group!(benches, encrypt, decrypt);
criterion_main!(benches);